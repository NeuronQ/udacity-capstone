> size: 387948
datetime    datetime64[ns]
low                float64
high               float64
open               float64
close              float64
volume             float64
weekday              int64
dtype: object
                      datetime     low    high    open   close      volume  weekday
timestamp                                                                          
1422745200 2015-01-31 23:00:00  224.51  225.69  225.38  224.51   29.638700        5
1422745500 2015-01-31 23:05:00  224.00  225.59  224.62  224.00   52.189176        5
1422745800 2015-01-31 23:10:00  221.99  223.92  223.91  221.99   40.262566        5
1422746100 2015-01-31 23:15:00  218.00  222.00  222.00  218.00  163.490760        5
1422746400 2015-01-31 23:20:00  217.11  218.89  217.92  218.22   96.317898        5
                      datetime      low     high     open    close     volume  weekday
timestamp                                                                             
1539128100 2018-10-09 23:35:00  6590.30  6593.48  6591.54  6590.30  17.148190        1
1539128400 2018-10-09 23:40:00  6586.55  6590.31  6590.31  6589.30  15.269094        1
1539128700 2018-10-09 23:45:00  6589.29  6589.69  6589.30  6589.48  12.466310        1
1539129000 2018-10-09 23:50:00  6589.47  6592.81  6589.48  6591.85  14.972801        1
1539129300 2018-10-09 23:55:00  6589.47  6592.81  6591.84  6589.48  31.305392        1

   ------ RUN 25000 (from 0, train on 25000, test on 3000)

data ~ (28000, 6)
--- 0.016s to model compilation time


--- Created model id: 139842970595408
Tensor("lstm_1_input:0", shape=(?, 100, 6), dtype=float32)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 100, 100)          42800     
_________________________________________________________________
dropout_1 (Dropout)          (None, 100, 100)          0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 50)                30200     
_________________________________________________________________
dropout_2 (Dropout)          (None, 50)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 51        
=================================================================
Total params: 73,051
Trainable params: 73,051
Non-trainable params: 0
_________________________________________________________________
None
Tensor("dense_1/BiasAdd:0", shape=(?, 1), dtype=float32)

Train on 23654 samples, validate on 1245 samples
Epoch 1/3

  512/23654 [..............................] - ETA: 1:29 - loss: 0.0093
 1024/23654 [>.............................] - ETA: 50s - loss: 0.1254 
 1536/23654 [>.............................] - ETA: 37s - loss: 0.0946
 2048/23654 [=>............................] - ETA: 30s - loss: 0.0726
 2560/23654 [==>...........................] - ETA: 26s - loss: 0.0591
 3072/23654 [==>...........................] - ETA: 23s - loss: 0.0499
 3584/23654 [===>..........................] - ETA: 21s - loss: 0.0430
 4096/23654 [====>.........................] - ETA: 20s - loss: 0.0379
 4608/23654 [====>.........................] - ETA: 18s - loss: 0.0341
 5120/23654 [=====>........................] - ETA: 17s - loss: 0.0310
 5632/23654 [======>.......................] - ETA: 16s - loss: 0.0283
 6144/23654 [======>.......................] - ETA: 15s - loss: 0.0260
 6656/23654 [=======>......................] - ETA: 14s - loss: 0.0242
 7168/23654 [========>.....................] - ETA: 13s - loss: 0.0226
 7680/23654 [========>.....................] - ETA: 13s - loss: 0.0212
 8192/23654 [=========>....................] - ETA: 12s - loss: 0.0200
 8704/23654 [==========>...................] - ETA: 11s - loss: 0.0190
 9216/23654 [==========>...................] - ETA: 11s - loss: 0.0181
 9728/23654 [===========>..................] - ETA: 10s - loss: 0.0173
10240/23654 [===========>..................] - ETA: 10s - loss: 0.0167
10752/23654 [============>.................] - ETA: 9s - loss: 0.0161 
11264/23654 [=============>................] - ETA: 9s - loss: 0.0155
11776/23654 [=============>................] - ETA: 8s - loss: 0.0150
12288/23654 [==============>...............] - ETA: 8s - loss: 0.0144
12800/23654 [===============>..............] - ETA: 7s - loss: 0.0140
13312/23654 [===============>..............] - ETA: 7s - loss: 0.0136
13824/23654 [================>.............] - ETA: 7s - loss: 0.0133
14336/23654 [=================>............] - ETA: 6s - loss: 0.0129
14848/23654 [=================>............] - ETA: 6s - loss: 0.0127
15360/23654 [==================>...........] - ETA: 5s - loss: 0.0123
15872/23654 [===================>..........] - ETA: 5s - loss: 0.0120
16384/23654 [===================>..........] - ETA: 5s - loss: 0.0117
16896/23654 [====================>.........] - ETA: 4s - loss: 0.0114
17408/23654 [=====================>........] - ETA: 4s - loss: 0.0111
17920/23654 [=====================>........] - ETA: 3s - loss: 0.0108
18432/23654 [======================>.......] - ETA: 3s - loss: 0.0106
18944/23654 [=======================>......] - ETA: 3s - loss: 0.0104
19456/23654 [=======================>......] - ETA: 2s - loss: 0.0103
19968/23654 [========================>.....] - ETA: 2s - loss: 0.0101
20480/23654 [========================>.....] - ETA: 2s - loss: 0.0099
20992/23654 [=========================>....] - ETA: 1s - loss: 0.0097
21504/23654 [==========================>...] - ETA: 1s - loss: 0.0095
22016/23654 [==========================>...] - ETA: 1s - loss: 0.0093
22528/23654 [===========================>..] - ETA: 0s - loss: 0.0091
23040/23654 [============================>.] - ETA: 0s - loss: 0.0089
23552/23654 [============================>.] - ETA: 0s - loss: 0.0088
23654/23654 [==============================] - 16s 695us/step - loss: 0.0088 - val_loss: 7.3153e-04
Epoch 2/3

  512/23654 [..............................] - ETA: 13s - loss: 0.0027
 1024/23654 [>.............................] - ETA: 12s - loss: 0.0065
 1536/23654 [>.............................] - ETA: 13s - loss: 0.0097
 2048/23654 [=>............................] - ETA: 12s - loss: 0.0085
 2560/23654 [==>...........................] - ETA: 12s - loss: 0.0072
 3072/23654 [==>...........................] - ETA: 12s - loss: 0.0062
 3584/23654 [===>..........................] - ETA: 12s - loss: 0.0054
 4096/23654 [====>.........................] - ETA: 11s - loss: 0.0048
 4608/23654 [====>.........................] - ETA: 11s - loss: 0.0044
 5120/23654 [=====>........................] - ETA: 11s - loss: 0.0042
 5632/23654 [======>.......................] - ETA: 10s - loss: 0.0039
 6144/23654 [======>.......................] - ETA: 10s - loss: 0.0036
 6656/23654 [=======>......................] - ETA: 10s - loss: 0.0034
 7168/23654 [========>.....................] - ETA: 10s - loss: 0.0032
 7680/23654 [========>.....................] - ETA: 10s - loss: 0.0030
 8192/23654 [=========>....................] - ETA: 9s - loss: 0.0029 
 8704/23654 [==========>...................] - ETA: 9s - loss: 0.0028
 9216/23654 [==========>...................] - ETA: 8s - loss: 0.0027
 9728/23654 [===========>..................] - ETA: 8s - loss: 0.0027
10240/23654 [===========>..................] - ETA: 8s - loss: 0.0027> size: 387948
datetime    datetime64[ns]
low                float64
high               float64
open               float64
close              float64
volume             float64
weekday              int64
dtype: object
                      datetime     low    high    open   close      volume  weekday
timestamp                                                                          
1422745200 2015-01-31 23:00:00  224.51  225.69  225.38  224.51   29.638700        5
1422745500 2015-01-31 23:05:00  224.00  225.59  224.62  224.00   52.189176        5
1422745800 2015-01-31 23:10:00  221.99  223.92  223.91  221.99   40.262566        5
1422746100 2015-01-31 23:15:00  218.00  222.00  222.00  218.00  163.490760        5
1422746400 2015-01-31 23:20:00  217.11  218.89  217.92  218.22   96.317898        5
                      datetime      low     high     open    close     volume  weekday
timestamp                                                                             
1539128100 2018-10-09 23:35:00  6590.30  6593.48  6591.54  6590.30  17.148190        1
1539128400 2018-10-09 23:40:00  6586.55  6590.31  6590.31  6589.30  15.269094        1
1539128700 2018-10-09 23:45:00  6589.29  6589.69  6589.30  6589.48  12.466310        1
1539129000 2018-10-09 23:50:00  6589.47  6592.81  6589.48  6591.85  14.972801        1
1539129300 2018-10-09 23:55:00  6589.47  6592.81  6591.84  6589.48  31.305392        1

   ------ RUN 25000 (from 0, train on 25000, test on 3000)

data ~ (28000, 6)
--- 0.016s to model compilation time


--- Created model id: 139938186014800
Tensor("lstm_1_input:0", shape=(?, 100, 6), dtype=float32)
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
lstm_1 (LSTM)                (None, 100, 100)          42800     
_________________________________________________________________
dropout_1 (Dropout)          (None, 100, 100)          0         
_________________________________________________________________
lstm_2 (LSTM)                (None, 50)                30200     
_________________________________________________________________
dropout_2 (Dropout)          (None, 50)                0         
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 51        
=================================================================
Total params: 73,051
Trainable params: 73,051
Non-trainable params: 0
_________________________________________________________________
None
Tensor("dense_1/BiasAdd:0", shape=(?, 1), dtype=float32)

Train on 23654 samples, validate on 1245 samples
Epoch 1/3

  512/23654 [..............................] - ETA: 1:30 - loss: 0.0414
 1024/23654 [>.............................] - ETA: 50s - loss: 0.1731 
 1536/23654 [>.............................] - ETA: 37s - loss: 0.1182
 2048/23654 [=>............................] - ETA: 30s - loss: 0.0900
 2560/23654 [==>...........................] - ETA: 26s - loss: 0.0728
 3072/23654 [==>...........................] - ETA: 23s - loss: 0.0614
 3584/23654 [===>..........................] - ETA: 21s - loss: 0.0530
 4096/23654 [====>.........................] - ETA: 19s - loss: 0.0466
 4608/23654 [====>.........................] - ETA: 18s - loss: 0.0418
 5120/23654 [=====>........................] - ETA: 17s - loss: 0.0380
 5632/23654 [======>.......................] - ETA: 16s - loss: 0.0347
 6144/23654 [======>.......................] - ETA: 15s - loss: 0.0319
 6656/23654 [=======>......................] - ETA: 14s - loss: 0.0297
 7168/23654 [========>.....................] - ETA: 13s - loss: 0.0277
 7680/23654 [========>.....................] - ETA: 13s - loss: 0.0261
 8192/23654 [=========>....................] - ETA: 12s - loss: 0.0246
 8704/23654 [==========>...................] - ETA: 11s - loss: 0.0234
 9216/23654 [==========>...................] - ETA: 11s - loss: 0.0223
 9728/23654 [===========>..................] - ETA: 10s - loss: 0.0212
10240/23654 [===========>..................] - ETA: 10s - loss: 0.0203
10752/23654 [============>.................] - ETA: 9s - loss: 0.0195 
11264/23654 [=============>................] - ETA: 9s - loss: 0.0188
11776/23654 [=============>................] - ETA: 8s - loss: 0.0180
12288/23654 [==============>...............] - ETA: 8s - loss: 0.0174
12800/23654 [===============>..............] - ETA: 7s - loss: 0.0167
13312/23654 [===============>..............] - ETA: 7s - loss: 0.0162
13824/23654 [================>.............] - ETA: 7s - loss: 0.0157
14336/23654 [=================>............] - ETA: 6s - loss: 0.0152
14848/23654 [=================>............] - ETA: 6s - loss: 0.0148
15360/23654 [==================>...........] - ETA: 5s - loss: 0.0144
15872/23654 [===================>..........] - ETA: 5s - loss: 0.0140
16384/23654 [===================>..........] - ETA: 5s - loss: 0.0137
16896/23654 [====================>.........] - ETA: 4s - loss: 0.0135
17408/23654 [=====================>........] - ETA: 4s - loss: 0.0133
17920/23654 [=====================>........] - ETA: 3s - loss: 0.0130
18432/23654 [======================>.......] - ETA: 3s - loss: 0.0127
18944/23654 [=======================>......] - ETA: 3s - loss: 0.0125
19456/23654 [=======================>......] - ETA: 2s - loss: 0.0123
19968/23654 [========================>.....] - ETA: 2s - loss: 0.0120
20480/23654 [========================>.....] - ETA: 2s - loss: 0.0118
20992/23654 [=========================>....] - ETA: 1s - loss: 0.0115
21504/23654 [==========================>...] - ETA: 1s - loss: 0.0113
22016/23654 [==========================>...] - ETA: 1s - loss: 0.0111
22528/23654 [===========================>..] - ETA: 0s - loss: 0.0108